# 基于 SPF 的分布式数据传输框架
### 项目概述
本项目实现了一个基于最短路径优先（SPF）算法的分布式数据传输框架，用于广域网络环境。该系统解决了大规模分布式数据库系统中的高效数据路由问题，在节点间频繁数据传输可能导致性能瓶颈的场景下，提供最优路径选择。

### 项目目标
本项目的主要目标是设计并实现一个分布式路由系统，具备以下能力：

- 自动发现网络拓扑和节点成员关系
- 使用 SPF算法计算最优路由路径
- 沿最短路径转发数据包
- 动态适应网络变化（链路代价更新、节点故障）
- 为业务应用提供简洁的抽象接口层
### 系统架构
系统分为三个主要层次：

##### 第一层：集群管理层（Serf）
作用：分布式成员管理和拓扑同步

职责：

节点发现和故障检测
基于 Gossip 的事件传播
在集群中广播链路代价更新
核心特性：

使用 HashiCorp Serf 提供可靠的 Gossip 协议
维护节点元数据（node_id、grpc_addr）
传播自定义事件（link-update、拓扑变化）
Serf 不负责的事情：

不存储完整的拓扑图结构
不计算路由路径
不转发数据包
第二层：数据传输层（gRPC）
作用：点对点可靠数据传输

职责：

在节点间转发数据包
链路质量探测（RTT 测量）
请求-响应通信模式
核心接口：

ForwardPacket：多跳数据包转发
ProbeLinkQuality：链路代价测量
Ping：健康检查
为什么用 gRPC：

适合大数据传输
可靠的点对点通信
数据平面性能优于 Gossip
第三层：路由层（SPF 实现）
作用：最短路径计算和路由管理

核心组件：

Graph（图结构）：

存储网络拓扑（节点和边）
维护链路代价（权重）
线程安全操作
RouteTable（路由表）：

映射目标节点到下一跳
存储完整路径用于调试
每个节点的路由信息
RouteManager（路由管理器）：

执行 Dijkstra 算法
在拓扑变化时重新计算路由
提供路由查询接口
TopologySync（拓扑同步）：

处理 Serf 事件
在链路变化时更新 Graph
触发 SPF 重新计算